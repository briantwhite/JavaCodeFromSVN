trying to get jdom to work
just plain folder lib/ gets into CVS but never uploaded!
try New... Source Folder called lib/
still a pain..
lots of fussing 
	finally worked
	

9/9/08
refactoring to model-view-controller
	model = SurveyData singleton
	

10/3/08
made parameters
	Scoring = true enables scoring mode if Password = SurveyUI.PASSWORD

- permanently enabled for debugging purposes in surveyUI


10/9/08
set up database on www.securebio.umb.edu

dbname = trees
user  = treesurvey
pswd = tr335urvey

logged in as root
mysql -u root -pmy3quel

mysql> show databases;
+------------+
| Database   |
+------------+
| COII       |
| blog       |
| fishies_db |
| grades     |
| mysql      |
| test       |
| webdb      |
+------------+
7 rows in set (0.00 sec)

mysql> create database trees;

use trees;
grant all on trees.* to treesurvey@localhost identified by "tr335urvey";
mysql> create table student_data (
    -> name varchar(50),
    -> prepost varchar(10),
    -> date datetime,
    -> tree mediumblob,
    -> Q1 blob,
    -> Q2 blob,
    -> Q3 blob);

mysql> show tables;
+-----------------+
| Tables_in_trees |
+-----------------+
| student_data    |
+-----------------+
1 row in set (0.00 sec)

mysql> describe student_data;
+---------+-------------+------+-----+---------+-------+
| Field   | Type        | Null | Key | Default | Extra |
+---------+-------------+------+-----+---------+-------+
| name    | varchar(50) | YES  |     | NULL    |       |
| prepost | varchar(10) | YES  |     | NULL    |       |
| date    | datetime    | YES  |     | NULL    |       |
| tree    | mediumblob  | YES  |     | NULL    |       |
| Q1      | blob        | YES  |     | NULL    |       |
| Q2      | blob        | YES  |     | NULL    |       |
| Q3      | blob        | YES  |     | NULL    |       |
+---------+-------------+------+-----+---------+-------+
7 rows in set (0.00 sec)

edited /etc/cron.daily/backup_databases to backup this db
put new version on securebio

put treeDB.pm in /usr/lib/perl5/5.8.5
chmod +x

10/14/08
trying to use javascript to talk to applet
does not work in safari!
does in firefox.

10/16/08
tried in safari using a safari bookmark that lets you run arbitrary javascript code
tried to look at document.TreeApplet and got this
Error: java.security.PrivilegedActionException: sun.plugin.liveconnect.OriginNotAllowedException: 
      JavaScript is not from the same origin as the Java code, 
      caller=https://www.securebio.umb.edu/cgi-bin/TreeSurvey.pl, 
      callee=http://www.securebio.umb.edu/phylogenySurvey.jar

note that the caller is in https and the callee is http
therefore, move phylogenySurvey.jar to /var/www/sslhtdocs
and change reference in TreeSurvey.pl

now works!!

10/21/08
trouble debugging applet
it would not be updated in browser
therefore (on server only) change name to phylogenySurvey.1.jar etc

still NG
the applet keeps the links & puts all organisms back to start
the link persists even if logged in to another user!
- the browser must be caching something!

10/22/08
tried using start() in JApplet
still NG

10/31/08
finally added stop() method to applet 
also SurveyData.reset() that resets the database
now there is no carryover
BUT state not restored - looking at html, the tree description is incomplete
- url encoding is messing it up
- need another way to deal with "poison" characters - so it's not read as XML 
- it was not being restored because I was resetting the SurveyData at the wrong time!

now AOK - need to connect to db

almost working -
	1) date saves 00 00 00 etc.
	2) on first entry, any moved organisms are duplicated (?)
