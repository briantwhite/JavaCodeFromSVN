11/19/20
started setting up project

follow recipe in jsVGL

in eclipse
- new google -> web application project
	name: jsAipotu
	package: edu.umb.jsAipotu
	create new project in workspace
- team -> add to index
- team -> commit (initial commit)
- team -> push to upstream

worked.

nuked useless stuff:
-src/edu.umb.jsAipotu/client
	GreetingService & GreetingServiceAsnych
package edu.umb.jsAipotu.server
package edu.umb.jsAipotu.shared

keep getting errors that are just annoying but I can't fix:

An error has occurred. See error log for more details.
Path must include project and resource name: /.gitignore

but .gitignore is in the repository root as well as the project root
can't find this error on google
posted to StackExchange with question "Eclipse 2020-09 (4.17.0) on OS X 10.13 keeps wanting me to put .gitignore and .DS_store on the path"

moved in packages
- make new package eg edu.umb.jsAipotu.client.Genetics
- go into Aipotu/Genetics
- select all; copy
- click new package; paste

11/20/20
after reboot, the "path..." error is gone until first use of git.

11/22/20
try going into .gitignore and deleting the only listing there "/test-classes/"
may have done it - no. It now fusses about .DS_Store and .gitignore.
no help.

in the git settings for Eclipse, the default location is /Users/brian/git/
	there is no .gitignore there - add it and see. NO HELP.

try going to Team -> Advanced -> Clean... and cleaning everything it found.

hmm. now it seems only to be fussing about .DS_Store

try removing all of them from the repo https://intellipaat.com/community/9089/how-can-i-remove-dsstore-files-from-a-git-repository-gitignore-dsstore
go to /Users/brian/git
find . -name .DS_Store -print0 | xargs -0 git rm -f --ignore-unmatch
it failed because this directory isn't a repo
went into /Users/brian/git/JavaCodeFromSVN/
created empty .gitignore
then ran
find . -name .DS_Store -print0 | xargs -0 git rm -f --ignore-unmatch
	ran OK
echo .DS_Store >> .gitignore
git add .gitignore
git commit -m '.DS_Store banished'

testing. FIXED!

11/24/20
need to set up the gui sensibly
here's a good reference site: http://www.gwtproject.org/doc/latest/DevGuide.html
also
http://samples.gwtproject.org/samples/Showcase/Showcase.html

11/30/20
Notes on the Greenhouse - maybe start here
- save all organisms in the Gh in one big .greenhouse json file (or xml, whichever is easier)
- for each organism, save it all:
	- upper/lower DNA
	- upper/lower AA seq
	- upper/lower protein struct
	- upper/lower color
	- overall color
- on startup, it looks for starting.greenhouse in the web directory and loads it
- have menu item to replace current Gh with file
- have menu item to save it to .greenhouse file on local disk

start going class-by-class and fixing the errors & note anything special
* lots of things fixed by 'organize imports' - do this for all classes with errors first

- only molBiol has residual errors

edit molGenExp/MolGenExp.java to 
	not have a main method - it will be instantiated by JsAipotu.java
	nix greehouseLoader since greenhouse will hold all needed info on each organism

try to gwt compile and get this error:
[ERROR] Line 13: No source code is available for type edu.umb.jsAipotu.molGenExp.MolGenExp; did you forget to inherit a required module?
[ERROR] Hint: Check the inheritance chain from your module; it may not be inheriting a required module or a module may not be adding its source path entries properly

but the class is there. What's up?
sometimes, this is an issue with edu.umb.jsAipotu/JsAipotu.gwt.xml but it looks the same as the one from JsVGL

this link http://codeinventions.blogspot.com/2014/12/no-source-code-is-available-for-type-did-you-forget-to-inherit-a-required-module.html
says it's because I'm trying to use non-gwt thingies in a gwt project.
Probably the GUI classes.
If you take out the instantiation of an MolGenExp, the error disappears.

Try building the MGX GUI in JsAipotu.java bit by bit - based on MolGenExp.java (which you'll eventually delete)

started with menu.

12/1/20
git had been fussing about big files on commits
found this file https://github.com/github/gitignore/blob/master/GWT.gitignore
added them to this project's .gitignore

12/2/20
start working to get greenhouse running (see 11/30 notes)
json or XML?
it looks like GWT has a JsonUtils http://www.gwtproject.org/javadoc/latest/com/google/gwt/core/client/JsonUtils.html 
	so use json
	
first, get the full info for each greehouse strain - make a temporary change to Aipotu's OrganismFactory

In FoldedProteinArchive:
	public synchronized void add(String aaSeq, String proteinString, Color color) {
		archive.put(aaSeq, 
				new FoldedAndColoredProtein(proteinString, color));
		System.out.println(aaSeq);
		System.out.println(proteinString);
		totalFoldedSequences++;
	}

In OrganismFactory:
	public Organism createOrganism(String name, String DNA1, String DNA2) 
	throws FoldingException {

		ExpressedGene eg1 = geneExpresser.expressGene(DNA1, -1);
		FoldedProteinWithImages fp1 = foldingManager.foldWithPix(eg1.getProtein());

		ExpressedGene eg2 = geneExpresser.expressGene(DNA2, -1);
		FoldedProteinWithImages fp2 = foldingManager.foldWithPix(eg2.getProtein());
		
		System.out.println(name);
		System.out.println(DNA1);
		System.out.println(DNA2);
		System.out.println(eg1.getProtein());
		System.out.println(eg2.getProtein());
		System.out.println(fp1.getColor().toString());
		System.out.println(fp2.getColor().toString());
		return createOrganism(name,
				new ExpressedAndFoldedGene(eg1, fp1),
				new ExpressedAndFoldedGene(eg2, fp2));
	}

result:
     [java] MSNRHILLVYWRQ
     [java] M: E:S:NE:N:NW:R: W:H:SW:I:SW:L:SE:L: W:V:NW:Y:NE:W:NW:R:NW:Q:none:
     [java] MSTSAHFVSVLAAVVKKKK
     [java] M: E:S:NE:T: W:S: W:A:NW:H:SW:F: W:V: W:S:SE:V: E:L:SW:A: E:A:NE:V:SE:V:SE:K:SE:K:SE:K:SE:K:none:
     [java] MSKSAHFVSVLAAVVKKKK
     [java] M: E:S:NE:K: W:S: W:A:NW:H:SW:F: W:V: W:S:SE:V: E:L:SW:A: E:A:NE:V:SE:V:SE:K:SE:K:SE:K:SE:K:none:
     [java] MSNRHILLVFCRQ
     [java] M: E:S:NE:N:NW:R: W:H:SW:I:SW:L:SE:L: W:V:NW:F:NE:C:NW:R:NW:Q:none:
     [java] MLRVPRYTLQFSFTGFPGASEWDVFGT
     [java] M: E:L: E:R:NW:V:NE:P:NW:R:SW:Y: W:T:SE:L: W:Q:SW:F:SW:S: E:F:SW:T: E:G:NE:F:SE:P:SE:G:SW:A:SE:S:SW:E:NW:W: W:D:NE:V:NE:F: W:G: W:T:none:
     [java] MSNRHILLVVCRQ
     [java] M: E:S:NE:N:NW:R: W:H:SW:I:SW:L:SE:L: W:V:NW:V:NE:C:NW:R:NW:Q:none:
     [java] MSNRHILLVYCRQ
     [java] M: E:S:NE:N:NW:R: W:H:SW:I:SW:L:SE:L: W:V:NW:Y:NE:C:NW:R:NW:Q:none:
     [java] MSNRHILLVWCRQ
     [java] M: E:S:NE:N:NW:R: W:H:SW:I:SW:L:SE:L: W:V:NW:W:NE:C:NW:R:NW:Q:none:
     [java] MSNRHILGYTKVSVRAAVVKKKK
     [java] M: E:S:NE:N:NW:R: W:H:SW:I:SW:L:SE:G: W:Y:SW:T:NW:K:NE:V: W:S:NE:V:NW:R: E:A:SE:A:NE:V:NW:V:NW:K:NW:K:NW:K:NW:K:none:
     [java] Green-1
     [java] CAGCTATAACCGAGATTGATGTCTAGTGCGATAAGCCCCAAAGATCGGCACATTTTGTGCGCTATACAAAGGTTAGTGTACTGGCGGCAGTAGTAGGGGGCGT
     [java] CAGCTATAACCGAGATTGATGTCTAGTGCGATAAGCCCCAAAGATCGGCACATTTTGTGCGCTATACAAAGGTTAGTGTACTGGCGGCAGTAGTAGGGGGCGT
     [java] MetSerAsnArgHisIleLeuLeuValTyrTrpArgGln
     [java] MetSerAsnArgHisIleLeuLeuValTyrTrpArgGln
     [java] java.awt.Color[r=0,g=255,b=0]
     [java] java.awt.Color[r=0,g=255,b=0]
     [java] Green-2
     [java] CAGCTATAACCGAGATTGATGTCTAGTGCGATAAGCCCCAAAGATCGGCACATTTTGTGCGCTATACAAAGGTTAGTGTACTGTCGGCAGTAGTAGGGGGCGT
     [java] CAGCTATAACCGAGATTGATGTCTAGTGCGATAAGCCCCAAAGATCGGCACATTTTGTGCGCTATACAAAGGTTAGTGTGGTGTCGGCAGTAGTAGGGGGCGT
     [java] MetSerAsnArgHisIleLeuLeuValTyrCysArgGln
     [java] MetSerAsnArgHisIleLeuLeuValTrpCysArgGln
     [java] java.awt.Color[r=0,g=0,b=255]
     [java] java.awt.Color[r=255,g=255,b=0]
     [java] Red
     [java] CAGCTATAACCGAGATTGATGTCTAGTGCGATAAGCCCCAAAGATCGGCACATTTTGTGCGCTATACAAAGGTTAGTGTTCTGTCGGCAGTAGTAGGGGGCGT
     [java] CAGCTATGACCGAGATTGATGTCTAGTGCGATAAGCCCCAAAGATCGGCACATTTTGTGCGCTATACAAAGGTTAGTGTTCTGTCGGCAGTAGTAGGGGGCGT
     [java] MetSerAsnArgHisIleLeuLeuValPheCysArgGln
     [java] java.awt.Color[r=255,g=0,b=0]
     [java] java.awt.Color[r=255,g=255,b=255]
     [java] White
     [java] CAGCTATAACCGAGATTGATGTCTAGTGCGATAAGCCCCAAAGATCGGCACATTTTGTGCGCTATACAAAGGTTAGTGGTCTGTCGGCAGTAGTAGGGGGCGT
     [java] CAGCTATAACCGAGATTGATGTCTAGTGCGATAAGCCCCAAAGATCGGCACATTTTGTGCGCTATACAAAGGTTAGTGGTCTGTCGGCAGTAGTAGGGGGCGT
     [java] MetSerAsnArgHisIleLeuLeuValValCysArgGln
     [java] MetSerAsnArgHisIleLeuLeuValValCysArgGln
     [java] java.awt.Color[r=255,g=255,b=255]
     [java] java.awt.Color[r=255,g=255,b=255]

need to convert to json by hand. Use this site https://jsoneditoronline.org/#right=local.movuxo&left=local.wedunu
	made file "default.greenhouse"
when reading it in, gonna need sanity checks to be sure I didn't mess up the protein sequences

how to read it in? https://examples.javacodegeeks.com/enterprise-java/gwt/gwt-json-example/
got it working - it can read things in

need to set up a scrollable list of items

use a CellList<Organism> of OrganismCell<Organism>s
	this is a useful example http://samples.gwtproject.org/samples/Showcase/Showcase.html#!CwCellList
	this is a simpler one http://www.gwtproject.org/doc/latest/DevGuideUiCustomCells.html
		it looks like you put one cell in the list as a prototype and then add to the list.
		
can't get the classes using the CellList etc to compile 
try going simple - just a list of strings for now.
just copy code from http://www.gwtproject.org/doc/latest/DevGuideUiCustomCells.html
still NG - it doesn't like OrganismCell extending AbstractCell
try their built-in "TextCell" from http://www.gwtproject.org/doc/latest/DevGuideUiCellWidgets.html
	OK, that works.
best to use their ImageCell	or SafeHtmlCell (put in image AND label)
	BUT these will need a link back to the actual organism (unless you use a Custom CellList - that I can't seem to get to work)

info on actions on cells https://stackoverflow.com/questions/5257807/how-to-add-clickhandler-on-imagecell-in-gwt-celltable

maybe, since there are only 8 colors, you might make 8 (or 16 with large/small) canned images to draw on.
	actually 9 colors since "folded in a corner" yields gray 
	made them and put them in images/

try to move the code to a Greenhouse class that extends CellList<String> - it won't compile.
	No source code is available for type edu.umb.jsAipotu.molGenExp.Greenhouse; did you forget to inherit a required module?

so, far, this is the only thing that compiles (in JsAipotu.java)
		greenhouseWrapper = new CaptionPanel("Greenhouse");
//		Greenhouse greenhouse = new Greenhouse();
//		greenhousePanel = new ScrollPanel(greenhouse.getCellList());
		TextCell cell = new TextCell();
		List<String> names = Arrays.asList("tom", "dick", "harry");
		CellList<String> cellList = new CellList<String>(cell);
		cellList.setRowData(0, names);
		greenhousePanel = new ScrollPanel(cellList);
		greenhouseWrapper.setContentWidget(greenhousePanel);
		//loadGreenhouse("default.greenhouse", greenhouse);
		mainPanel.addWest(greenhousePanel, 100);

even an EMPTY Greenhouse.java won't compile!

Greenhouse.java is in molGenExp/
	try commenting out all code that leads to any errors in any files in molGenExp/ - still NG

try deleting and making a new Greenhouse.java - NG
maybe it's the name "Greenhouse" - try making a new class "Fred" and it fails to compile.

WTF??? - it's probably not seeing ANY of my classes.
Compare preferences of jsVGL - specifically Build Path - and jsAipotu is missing gwt-user.jar
	still NG
try fixing "order and export" to match jsVGL - still NG

the whole project is somehow hosed - it can't see any of the files in the

noticed important difference between jsVGL and jsAipotu - in jsVGL the packages are edu.umb.jsVGL.client.whatever
	but in jsAipotu, they're not in .client 
	and JsAipotu.java is in client/ so it can't see them
use refactor for each package and change name to include .client.
WORKS!!

trying to get sanity checks to work but the MGX classes need a lot of fixing to be GWT-compatable.

12/4/20
nice info on drawing in GWT here - it looks pretty simple
http://www.science.smith.edu/dftwiki/index.php/Tutorial:_The_Basics_of_a_Simple_GWT_Canvas_App

Q: Aipotu uses java.awt.Color - what is a smart gwt substitute?
	the link above uses CssColor - that might be good - use it.

revise default.greenhouse to save the folded protein archive.
	get the archive by starting java Aipotu, immediately saving the folded protein archive, and unzipping it

PROBLEM - the greenhouse loading is asynchronous so, if you do FoldedProteinArchive.getInstance(), it returns before the
	archive is full - it's waiting for the file.
	you can't just put that in a while size == 0 loop or it hangs.
	** need a better solution ***
	- FALLBACK: could just build FPA with some hard-coded starting entries 
		(not the best because it will make other saved greenhouses slow to load - whatever!)

12/7/20
better idea:
- on startup
	- make empty folded protein archive
	- start greenhouse loader that:
		- put entries into FPA
		- create organisms using DNA and data in FPA

did it but REMEMBER - the function returns BEFORE the GH is loaded
	the only 'safe' place is inside the request callback function - this won't run until the file is received

seems to load the FPA OK

now work on Organism - use a String for the image file name
work on RYBColorModel to include image file name lookup

all these changes percolate down into OrganismFactory and FoldingManager etc.
	will need to do carefully.
	
12/9/20
got most of the color needed for Organism Factory working 
need to work on the protein folding graphics.
it's in ProteinImageFactory.java
	you ask the grid to paint itself on a 2DGraphics thingy.
how do you do that in GWT?
	it looks like you can create a canvas with a pic in it and then add it to a widget as an image
		use Canvas instead of BufferedImage
currently in the middle of the GridCanvas
some useful sites:
http://www.gwtproject.org/javadoc/latest/com/google/gwt/canvas/dom/client/Context2d.html
http://blog.mrroa.com/2013/10/22/canvas-rendering-context-2d-overview/
filled circles https://www.html5canvastutorials.com/tutorials/html5-canvas-circles/

should GridCanvas subclass Canvas or some sort of panel?
	maybe neither - just have it HAVE a Canvas.

first, it'll be better to put the images and greenhouse in a ClientBundle so they're all loaded together
http://www.gwtproject.org/doc/latest/DevGuideClientBundle.html
	- made package edu.umb.jsAipotu.client.resources
	- made class in there Resources.java that implements the ClientBundle interface
compile fails "This method requires a body instead of a semicolon" in the ClientBundle for things like:
	@Source("black.gif")
	public ImageResource blackFlowerImage();
	<sigh> it needed to be public interface Resources extends ClientBundle (not class and extends)
works now (at least for the Greenhouse file)

trying to get console logging to work - can get it to show with a native method in Chrome's console but not eclipse.
in JsAipotu.java at the bottom:
	public static native void consoleLog(String message) /*-{
		console.log(message);
	}-*/;
call with JsAipotu.consoleLog(message)

12/10/20
working on Greenhouse loader to get it to build proper organisms as above 
	(all the way down into protein image making in GridCanvas and AminoAcid)

<sigh> need to create a Dimension class since there isn't one in GWT

still working to get rid of all compilation errors...

12/11/20
will need to get the GUI up and running
	big question - lay it out in one big panel or make many containers in the web page?
	also, use jsVGL as guide to layouts
	
also - need to see how you put a custom image somewhere 
	http://www.science.smith.edu/dftwiki/index.php/Tutorial:_The_Basics_of_a_Simple_GWT_Canvas_App

build it in parallel with the panels used in Aipotu

working on Workbenches - use GeneticsWorkbench as prototype
	leave in error-inducing functions as a reminder to fix

did:
	- genetics
	- biochem
	- mobo

12/14/20
To do:
- move all 'model' code (GeneExpresser, greenhouse loader, etc) out of JsAipotu.java (should just be GUI controller) to MolGenExp.java 
	did this
- dig down and make all the GUIs set up

started on GeneticsWorkPanel
	can you make multi-row celllist?
theres a FlexTable but maybe a table of buttons rather than a CellList would be better?
	but selection rules in a table?
	- leave error-generating methods in place to remind you to fix them
	
12/16/20
Idea: maybe, to be sure you can get images etc working, try commenting out the workpanels and workbenches and get the
	greenhouse to work
to do this right, you need to get OrganismFactory to work.
need to get down into folding code - nuke out reports and stats and energy and time measurements

take the hexagon-related stuff out of HexCanvas (it needed Polygon which isn't in GWT) - seems OK so far.

can't get it to compile without fussing about errors in BiochemWOorkbench and Workpanel but they're not needed
	who the fuck is instantiating them?
	if you comment out the instantiation of "OrganismFactory" the compilation errors go away
		this calls GeneExpresser and FoldingManager
put GeneExpresser back without any folding and it compiles.
in OrganismFactory, added instantiation of FoldingManager - no compile errors
	try putting back some method calls to FoldingManager
	FoldingManager.foldWithPix prevents compilation

it's in GridCanvas line 207 where it gets the background color from BiochemWorkbench
	for now, replace it with gray
	compiles

get a null reference if you try to make organisms - but it's in an obscure obfuscated method
	it's in OrganismFactory.createOrganism
	try compiling with the "detailed" option instead of "obfuscated"
it looks like the "combine color" is getting nulls out of the FoldedProteinArchive
	maybe I'm turning the color string into a CssColor wrong
	colors coming out of the parseColorString are ok
maybe the Request method is returning before the FPA has entries - nope, if you ask how many entries just before
	you call the load greenhouse method, you get 10

loooking in FoldingManager
	it is getting a good AA seq and finding the protein in the FPA

put in a crapload of print statements in FoldingManager
it's returning null
			try {
				polypeptide = PolypeptideFactory.getInstance().createFromProteinString(
						foldedAndColoredProtein.getProteinString());
				JsAipotu.consoleLog("FoldingManager 233: got this polypeptide: " + polypeptide.toString());
				hexCanvas.setGrid(new HexGrid(polypeptide));
			} catch (FoldingException e1) {
				JsAipotu.consoleLog("FOldingManager 236: folding exception: " + e1.getMessage());
				return null;
			}
it never gets to "FoldingManager 233" - and the error is:
	"direction not found. DIRECTION:"
	directionString parsing is getting an empty string as the first and only one to parse..

12/17/20
maybe need to split the string at whitespace not just a single space
that was it. In PolypeptideFactory line 263:
ArrayList<String> tokens = new ArrayList<String>(Arrays.asList(input.split("\\s+")));
fixes the problem

now a bug in the color to number map in RYBColorModel
	"Cannot read property 'java_lang_Integer_value' of undefined"
it may be that, if you make the keys be things like "white" instead of an RGB set, they're not equal
	changed CssColor specifications to RGB values not names
	fixed that one

OrganismFactory line 50 is getting a null color from one of the expressed and folded genes
	it's folding most of them without error but blowing up when the aa sequence is "" (nothing)
		how did we deal with this before in PolypeptideFactory?
			it probably fell through and made a Polypeptide(aminoAcids[0], directions[0])
		in this version, when it gets the empty string, the routine returns a one-member ArrayList (it should be 0).
		probably, the best is to have getTokens("") return an empty ArrayList
	fixed it!

now need to work on getting images into Greenhouse cells
	it's better to pass in ImageResource than Image

WORKS!!

see if the protein drawing stuff is working
for now, set up so if you click on a greenhouse entry it puts one protein in a separate div "test"

made JsAipotu.showImage(Canvas) that puts the image in "test"
	the images are misaligned but it seems to work
fix up the protein drawing code - it's in GridCanvas.java

first, see if you can put a canvas in a panel in the app itself - yep, just add it
	put it back to the test region

the mis-alignment is likely that the circle drawing is different (in AminoAcid.paint())
	original: g2d.fillOval(x, y, aminoAcidDiameter, aminoAcidDiameter);
		x, y is the coordinates of the upper left corner of the oval to be filled
	gwt: g2d.arc(x, y, GlobalDefaults.aaRadius, 0, 2 * Math.PI);
		it looks like the arc's x and y are the CENTER of the arc
	so try adding aaRadius to x and y in the arc() command.
	FIXED

some of the lettering is small and mis-alinged - fix that in AminoAcid.paint()
	default font is "10px sans-serif"
all set

back to genetics - how best to build a Tray
	HTML table of cells or buttons
	CellList? - can make it horizontal (a pain) but still only one row
	CellTable? - a pain because you have to define each column so it won't resize nicely
	FlexTable - probably not needed
it may be ok to just use a FlowPanel and add() them and it'll take xare of the rest
	what should the organisms in a cage be?
	can they be a cell? it would probably be good because it can be made with an organism built in
		and you can use the code from the greenhouse member
** it will be best to do this once you've read over the GWT book on order to see the best method

Maybe try to get mobo workpanel working
	first get CombinedColorPanel ok

12/18/20
moved the protein background color from BiochemWorkbench to GlobalDefaults 
	(so you don't have to have BiochemWB running to get proteins folded)

working on mobo workpanel - what's the best container for the HTML?
	TextArea where you setReadOnly(true)
	you can also getCursorPos()
try it.

working out bugs in MolBiolWorkpanel using the jsGenex code where I can.

(maybe do the same for the BiochemWorkpanel)

1/5/21
Need to figure out where in the DNA the user has clicked in MoBo
there's a selection event: https://developer.mozilla.org/en-US/docs/Web/API/Window/getSelection
	 window.getSelection() works in chrome - can you get what you need? anchorOffset might be the thing
more info here: https://w3c.github.io/selection-api/#dfn-selection
may work in gwt https://docs.sencha.com/gxt/4.x/javadoc/gwt-elemental-2.8.2/elemental/html/class-use/Selection.html
also here: https://stackoverflow.com/questions/20402259/how-can-i-get-gwt-html-selected-text
perhaps even better: https://code.google.com/archive/p/gwt-selection/

1/6/21
Got it to show a gene.
window.getSelection() gives the selected base in it's HTML element. That means that, if you select the 2nd base after the
promoter - the post-promoter DNA is it's own element - you get an offset of 2. So it doesn't help give the coordinates
from the START of the DNA. Not useful. Hmmm...

can get X coordinate of a click. How to turn that to a character index?
(middle of DNA base)
	DNA base	pixelX
		0		26
		10		104
		20		183
		30		260
		40		338
		50		416
		60		495
		70		572
		80		651
		90		729
		100		807
these are the same even when scrolled

better, since they may re-size, is to calculate the size of each character
if you can somehow get the graphics context, you can do this https://www.w3schools.com/tags/canvas_measuretext.asp
- actually, the pixel locations are stable on zoom.
- so find a linear approx to the above in excel
	base = (0.128 pixel) - 3.32
	
		geneDisplayPanel.addClickHandler(new ClickHandler() {   
			public void onClick(ClickEvent event) {
				int pixelX = event.getRelativeX(event.getRelativeElement());
				int baseNum = (int)((pixelX * 0.128) - 3.32);
				JsAipotu.consoleLog(Integer.toString(baseNum));
			}
		});

WORKS

1/7/21
Need to find a way to get the keyboard controls to work
- instead of HTML, use some editable text pane that you can fill with HTML
	and set up monster controlled editor
	maybe RichTextArea would be good
		it will display HTML nicely
		but the cursor location stuff isn't good - it changes when you scroll
			so no good unless you can fix this
		but it will give keyboard events.
		PUNT on it
- put a transparent text input or editing thingy over the HTML panel
- find some way to capture the key events
	https://stackoverflow.com/questions/7647118/is-there-a-way-to-trap-a-keyboard-event-in-gwt
- wrap it in a FocusPanel - that has kb events.
	KeyPress only does real characters
	KeyDown works for arrow keys

First, got clicking on a base to highlight the corresponding RNA etc.
got it going with FocusPanel!

1/8/21
Before you go further - put the size settings in the .css file
	make a different size for the inside scroll panel of each workpanel
worked out some layout issues

1/11/21
To do
- anytime you use EM units (width of an m), change to pixels since they're easier to understand
	DONE
- re-check the obfuscate option for compiling
	DONE
- re-do Greenhouse with an underlying list model as described in "GWT in action"
	try replacing the ArrayList<Organism> in Greenhouse.java with ListDataProvider<Organism>
	WORKS

move on to getting biochem workbench going

need to fix AminoAcidPalette to be AminoAcidPaletteBuilder class with one static method build()
	got it going

now biochem workpanel
	- don't need FoldedProteinPanel - will use a SimplePanel and draw on it
	- don't need ProteinHistoryCellRenderer either (Will use BiochemHistListItem)
the amino acid entry thing is a JTextField who's document is a TLCDocument
		what to use for the JTextField? - it must have a getDocument
			there doesn't appear to be a GWT equivalent
there's some relevant info here https://gwtgrabbag.wordpress.com/2010/12/26/gwt-detecting-changes-in-a-textbox-with-event-filtering-and-jsni/
	but it's a pain.
also https://gwtgrabbag.wordpress.com/2010/12/26/detecting-changes-in-a-gwt-textbox-by-sinking-events/
also https://stackoverflow.com/questions/19201132/gwt-input-event-on-textbox

1/12/21
the RichTextArea things are a pain - can get cursor but it's a kludge
	https://stackoverflow.com/questions/12542522/how-to-get-cursor-position-or-location-from-richtextarea-in-gwt
better is a plain TextArea http://www.gwtproject.org/javadoc/latest/com/google/gwt/user/client/ui/TextArea.html
	can get the cursor position and can set it so only one line of text is visible
PLAN
	- make ProteinSequenceEntryBox class
	- use TextArea
	- either:
		a) turn off editing and find the cursor with the method or by the click locator code from MoBo - BETTER
		b) leave editing on but respond to any selection by limiting it to particular amino acid(s)
			respond to selection by adjusting selection
	- deal with entry of aas or deletion by capturing keystrokes like in MoBo

this is turning into a pain
ValueBox may be better https://stackoverflow.com/questions/17685964/custom-renderer-in-gwt
another example https://stackoverflow.com/questions/10413645/converting-string-to-bigdecimal-in-gwt/10425061#10425061
but the renderer code seems to have no influence on the display???
	it's calling the getInstance() code but not the render() code. Why?
	- did it exactly like the bigdecimal one and you can set the text but the renderer has no effect
	tried http://www.java2s.com/example/java-src/pkg/com/google/gwt/sample/dynatablemvp/client/widgets/zipplusfourbox-137df.html
		no good
what am I missing?

probably best to go back to TextArea and turn on editing but
	- undderlying representation is 3-letter code
	- respond to clicks by putting cursor at end of aa
	- repond to selection by extending to several aas
	- respond to deleted by nuking whole aas
	- respond to typing of single letters by inserting whole aas

1/14/21
it's a mess if you turn on editing - the cursor movements seem to happen independently of the programmatic settings
	it moves right but the cursorPos() in the middle of a movement is really wrong
	and delete comes around AFTER the method returns and nukes the last char!
might be smarter to turn of editing - but then you lose the cursor and the arrow keys now scroll <sigh>
maybe can capture the key events before they get to the TextBox

try sinking the keyboard events - maybe will work.
	keyCode seems to work
		8 = delete
		37 = left arrow
		39 = right arrow
FINALLY got it working.
need to get folding to go.
Nuked
	TripleLetterCodeDocument
	SingleLetterCodeDocument

proteins fold nicely but coloring doesn't work.
	trouble looking up colors for mixing in RYBColorModel.java
got single color proteins colored properly but mixing causes an error
	when you make a TrpPhe core - orange - it blows up in mixHexagonalCores when it tries to get coreColors(0)
	also, it never seems to call RYBcolorModel.colorByAminoAcid if there's only one phobic in the core???

1/15/21
Played a little more:
- the reason a red protein is OK is that protein was in the database
- anytime you fold a protein that has a phobic core, it dies
- simple proteins without cores are folded AOK.

it's a fundamental problem with CssColors and GWT
	https://stackoverflow.com/questions/19748832/how-to-keep-a-list-of-csscolor-instances
basically, you can't pull a CssColor out of an ArrayList (and probably other complex data structures)
	it does work as a key in getImageResourceFromColor
need to re-do some of the coloring thing - but be careful since you already solved some of the problem in GreenhouseLoader
	make an ArrayList<String> of things like "255, 255,0" and make() colors from them.
WORKS - but need to think carefully about how you're doing color.
	- don't ever enter colors by rgb, use getColorByName()

need to do history list - use FoldedProteinWithImages as cell element
	got it going!

1/19/21
Notes going forward:
	- General
		- set compilation to obfuscate
		- setTitle() sets the tool tip text
	- Biochem
		- may need to deal with selection events - can you select a region?
		- add "clear sequence" button (and shift-delete key combination)
		- since there's a history list, see how it looks if you clear the folded structure display if the
			aa sequence changes (no more red border)
			- also gray out color chip
	- MoBo
		- need to sink browser events (maybe just the arrow keys) because arrow keys move the scroller 

1/20/21
MoBo: fix arrow key issue
	need to make new class analagous to ProteinSequenceEntryBox: GeneDisplayPanel
	not all the browser events work (probably since it's not editable)
		try RichTextArea instead of HTML
			can't get cursor position and clientX is hosed by scrolling
		try TextArea - NG, it won't show as HTML 
	go back to HTML
		try adding a key handler - NG
		try putting it in a FocusPanel
			a bit of a pain - since characters are all upper case and you have to check if shift held
WORKS

need to get DNA entry code in mobo going - actually, it's already there

work on biochem stuff
- selection? you can't select it all so don't worry
- try the 'clear the protein structure when you change the sequence' thing
	looks good
	deleting an aa didn't trigger an update - fixed
- add a 'clear aa seq' button
WORKS

now the to-do list:
- MoBo
	- get protein folding and hist list working
	- get color chips (including combined one) working
	- need to deal with FoldedInACorner (gray chips etc)
- Biochem
	- get color chips (including combined one) working
	- need to deal with FoldedInACorner (gray chips etc)

2/5/21
working on biochem hist list formatting
	can't seem to set the width properly - it seems to have something to do with the image.
	The thumbnail image is 300x150 as measured by the coordinateSpaceWidth and Height
	need to fix this.

2/8/21
the relevant code is in ProteinImageFactory.generateImages()
made it the right size but how can I set the style of a Cell?
the trick is to set it up in the template in BiochemHistListItem and set the table-layout:FIXED

started working on what happens when you click a hist list item
	trying to get selection working - it's a little sketchy

2/9/21
probably best to use the built-in selection model stuff and, instead of a popup menu, just
	have a "-> upper" and "-> lower" buttons at the top of the hist list
Got selection working but getting the popup in the right place is a huge pain - can't seem to make it resistant to scrolling.
got buttons there 
need to
	- enable buttons only when something is selected
	- get 'sending' to work

2/11/21
got the enabling of buttons and moving to workpanels going
- need to get the combined color thing going - OK now

do the same for MoBo
got it working!
- need to fix the nasty gray and red shading to something more friendly - it's not really necessary at all.

2/21/21
just nixed the background color changes in mobo since you can see the important effects in the button shading and the hist list

now, on to genetics - lots of errors to fix